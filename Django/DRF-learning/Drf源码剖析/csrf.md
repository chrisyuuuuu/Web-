- CSRFCheck
    - 继承
      - CsrfViewMiddleware
        - 继承
          - Middleware
            - 本质就是一个类装饰器
            - \__init__
            - \__call__
              - 切点函数调用
        - 函数
          - process_request
            - _get_token
              - token存在 存放到Request.META
          - process_view（验令牌）
            - csrf_processing_done 
              - True 代表CSRF检查通过了
              - request上的属性
            - csrf_exempt
              - 视图函数上  callback
              - True代表豁免
            - 安全方法不会进行检测
              - GET,HEAD,OPTIONS,TRACE
            - request不强制进行检查
              - _dont_enforce_csrf_checks
            - 获取referer
              - 获取上一个页面，获取来源
              - 如果为空，直接拒绝
            - 针对HTTPS和HTTP处理不一样
              - HTTPS
                - REFTERER检测
                - URL转换
                - 协议判定
                - 不安全的REFERER
                - 获取信任来源
                  - settings.CSRF_TRUSTED_ORINGS
              - POST
                - 获取csrfmiddlewaretoken
              - 先对token还原
              - 进行加盐比对
                - 成功接收
                - 不成功拒绝
          - process_response（发令牌）
            - 设置CSRF_TOKEN
      - 重写
        - _reject
